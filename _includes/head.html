<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  {%- comment -%}
  TITLE LOGIC:
  1) page.seo_title
  2) page.title + site.title
  3) site.title
  {%- endcomment -%}
  <title>
    {%- if page.seo_title -%}
      {{ page.seo_title }}
    {%- elsif page.title -%}
      {{ page.title }} | {{ site.title }}
    {%- else -%}
      {{ site.title }}
    {%- endif -%}
  </title>

  {%- comment -%}
  DESCRIPTION LOGIC:
  1) page.description
  2) page.excerpt
  3) site.description
  (Always cleaned for meta tag)
  {%- endcomment -%}
  {%- capture meta_description -%}
    {%- if page.description -%}
      {{ page.description | strip_html | strip_newlines | strip }}
    {%- elsif page.excerpt -%}
      {{ page.excerpt | strip_html | strip_newlines | truncate: 160 | strip }}
    {%- else -%}
      {{ site.description | strip_html | strip_newlines | strip }}
    {%- endif -%}
  {%- endcapture -%}
  <meta name="description" content="{{ meta_description }}"/>

  {%- comment -%}
  Robots
  {%- endcomment -%}
  {%- if page.noindex -%}
    <meta name="robots" content="noindex, nofollow">
  {%- else -%}
    <meta name="robots" content="index, follow">
  {%- endif -%}

  {%- comment -%}
  Canonical
  {%- endcomment -%}
  {%- assign canonical = page.canonical_url | default: page.url -%}
  <link rel="canonical" href="{{ canonical | absolute_url }}"/>

  {%- comment -%}
  Social image (OG/Twitter)
  {%- endcomment -%}
  {%- assign og_image = page.og_image | default: site.og_image | default: '/img/social/og-default.png' -%}

  {%- comment -%}
  Open Graph
  {%- endcomment -%}
  <meta property="og:locale" content="lt_LT">
  <meta property="og:site_name" content="{{ site.title }}">
  <meta property="og:type" content="{% if page.layout == 'post' or page.layout == 'personazas' %}article{% else %}website{% endif %}">
  <meta property="og:title" content="{% if page.og_title %}{{ page.og_title }}{% elsif page.seo_title %}{{ page.seo_title }}{% elsif page.personazas %}{{ page.personazas }} | {{ site.title }}{% elsif page.title %}{{ page.title }} | {{ site.title }}{% else %}{{ site.title }}{% endif %}">
  <meta property="og:description" content="{{ meta_description }}">
  <meta property="og:url" content="{{ canonical | absolute_url }}">
  <meta property="og:image" content="{{ og_image | absolute_url }}"/>

  {%- comment -%}
  Twitter
  {%- endcomment -%}
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{% if page.twitter_title %}{{ page.twitter_title }}{% elsif page.seo_title %}{{ page.seo_title }}{% elsif page.personazas %}{{ page.personazas }} | {{ site.title }}{% elsif page.title %}{{ page.title }} | {{ site.title }}{% else %}{{ site.title }}{% endif %}">
  <meta name="twitter:description" content="{{ meta_description }}">
  <meta name="twitter:image" content="{{ og_image | absolute_url }}">

  {%- comment -%}
  STRUCTURED DATA (JSON-LD)
  1) Breadcrumb + Product schema for persona pages (layout: personazas)
  2) ItemList for /personazai/ and legacy /visi-personazai/
  3) Service schema for /personazai/ (hub)
  {%- endcomment -%}

  {%- comment -%}
  HUB flags (A variant): /personazai/ is the main hub
  {%- endcomment -%}
  {%- assign is_personazai_hub = false -%}
  {%- if page.url == "/personazai/" or page.permalink == "/personazai/" -%}
    {%- assign is_personazai_hub = true -%}
  {%- endif -%}

  {%- assign is_visi_personazai = false -%}
  {%- if page.url == "/visi-personazai/" or page.permalink == "/visi-personazai/" -%}
    {%- assign is_visi_personazai = true -%}
  {%- endif -%}

  {%- if page.layout == "personazas" and page.personazas -%}
    {%- capture product_image -%}
      {%- if page.og_image -%}
        {{ page.og_image | absolute_url }}
      {%- else -%}
        {{ page.img_root | default: '/img/personazai/' | append: page.img | absolute_url }}
      {%- endif -%}
    {%- endcapture -%}

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "DokiPoki",
          "item": "{{ '/' | absolute_url }}"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Personažai",
          "item": "{{ '/personazai/' | absolute_url }}"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "{{ page.personazas | escape }}",
          "item": "{{ page.url | absolute_url }}"
        }
      ]
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Product",
      "name": "{{ page.personazas | escape }}",
      "url": "{{ page.url | absolute_url }}",
      "image": "{{ product_image | strip }}",
      "description": "{% if page.description %}{{ page.description | strip_html | strip_newlines | escape }}{% else %}{{ page.personazas | escape }} - vaikų švenčių personažas. Programa pritaikoma pagal jūsų poreikius.{% endif %}",
      "brand": {
        "@type": "Brand",
        "name": "DokiPoki"
      },
      "category": [
        "Vaikų švenčių personažas",
        "Animatorius"
      ],
      "areaServed": [
        { "@type": "City", "name": "Vilnius" },
        { "@type": "City", "name": "Kaunas" },
        { "@type": "Country", "name": "Lietuva" }
      ],
      "offers": {
        "@type": "Offer",
        "url": "{{ '/#Kaina' | absolute_url }}",
        "price": {{ site.data.pricing.hour_price | default: 100 | plus: 0 }},
        "priceCurrency": "{{ site.data.pricing.currency | default: 'EUR' }}",
        "unitCode": "HUR",
        "availability": "https://schema.org/InStock",
        "description": "Kaina nurodyta už 1 valandą."
      }
    }
    </script>
  {%- endif -%}

  {%- if is_personazai_hub -%}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Service",
      "name": "Personažai vaikų šventėms",
      "serviceType": "Animatorių personažai vaikų gimtadieniams",
      "provider": {
        "@type": "Organization",
        "name": "DokiPoki",
        "url": "{{ '/' | absolute_url }}"
      },
      "areaServed": {
        "@type": "Country",
        "name": "Lithuania"
      },
      "audience": {
        "@type": "PeopleAudience",
        "suggestedMinAge": "2",
        "suggestedMaxAge": "12"
      }
    }
    </script>
  {%- endif -%}

  {%- if is_personazai_hub or is_visi_personazai -%}
    {%- assign items = site.costumes | where_exp: "p", "p.has_page == true" -%}
    {%- if items == empty -%}
      {%- assign items = site.personazai | where_exp: "p", "p.has_page == true" -%}
    {%- endif -%}

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ItemList",
      "name": "DokiPoki personažai",
      "itemListElement": [
        {%- for p in items -%}
          {%- capture img_path -%}
            {%- if p.og_image -%}
              {{ p.og_image }}
            {%- else -%}
              {{ p.img_root | default: '/img/personazai/' }}{{ p.img }}
            {%- endif -%}
          {%- endcapture -%}
          {
            "@type": "ListItem",
            "position": {{ forloop.index }},
            "url": "{{ p.url | absolute_url }}",
            "name": "{{ p.personazas | default: p.title | escape }}",
            "image": "{{ img_path | strip | absolute_url }}"
          }{%- unless forloop.last -%},{%- endunless -%}
        {%- endfor -%}
      ]
    }
    </script>
  {%- endif -%}

  {%- comment -%}
  Preload assets
  {%- endcomment -%}
  <link rel="preload" href="{{ '/img/components/baloon_logo250hx255w.png' | relative_url }}" as="image">
  <link rel="preload" href="{{ '/img/components/baloon-line.png' | relative_url }}" as="image">

  <!-- Fonts -->
  <link rel="preload" href="{{ '/fonts/kg-kindergarden/KGMissKindergarten.ttf' | relative_url }}" as="font" type="font/ttf" crossorigin>
  <link rel="preload" href="{{ '/fonts/amatic-sc/amatic-sc-v9-latin_latin-ext-regular.woff2' | relative_url }}" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="{{ '/fonts/kg-air/KGThrowMyHandsUpintheAir.ttf' | relative_url }}" as="font" type="font/ttf" crossorigin>

  <!-- CSS & JS preload -->
  <link rel="preload" href="{{ '/css/main.css' | relative_url }}" as="style">
  <link rel="preload" href="{{ '/js/bin/main.js' | relative_url }}" as="script">
  <link rel="preload" href="{{ '/js/bin/materialize.js' | relative_url }}" as="script">

  <!-- Preconnect -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- Main CSS -->
  <link rel="stylesheet" href="{{ '/css/main.css' | relative_url }}" media="screen,projection">

  <!-- Google fonts -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet">

  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="16x16" href="{{ '/img/favicon-16.png?v=20260114' | relative_url }}">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ '/img/favicon-32.png?v=20260114' | relative_url }}">
  <link rel="icon" type="image/png" sizes="192x192" href="{{ '/img/favicon-192.png?v=20260114' | relative_url }}">
  <link rel="icon" type="image/png" sizes="512x512" href="{{ '/img/favicon-512.png?v=20260114' | relative_url }}">
  <link rel="apple-touch-icon" sizes="180x180" href="{{ '/img/favicon-192.png?v=20260114' | relative_url }}">

  <!-- Safari / iOS (Apple naudoja apple-touch-icon, geriausia turėti 180x180) -->
  <link rel="apple-touch-icon" sizes="180x180" href="{{ '/img/favicon-192.png' | relative_url }}">

  <!-- PWA / Android (jei neturi manifest, vistiek paliekam – nekenkia, bet geriausia turėti manifest.json) -->
  <meta name="theme-color" content="#7F95A8">

  <!-- Analytics -->
  {% include googleanalytics.html %}
</head>
